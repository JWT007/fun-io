<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Basic Archive Processing | Fun I/O</title>
    <meta name="description" content="Functional I/O for Java and Scala">
    
    
    <link rel="preload" href="/fun-io/assets/css/0.styles.6963bb8e.css" as="style"><link rel="preload" href="/fun-io/assets/js/app.6955aee8.js" as="script"><link rel="preload" href="/fun-io/assets/js/5.abe7762f.js" as="script"><link rel="prefetch" href="/fun-io/assets/js/2.d202cb91.js"><link rel="prefetch" href="/fun-io/assets/js/3.b1f57a15.js"><link rel="prefetch" href="/fun-io/assets/js/4.65eb385c.js"><link rel="prefetch" href="/fun-io/assets/js/6.74cc7dbe.js"><link rel="prefetch" href="/fun-io/assets/js/7.8ee39e84.js"><link rel="prefetch" href="/fun-io/assets/js/8.10bc08c1.js"><link rel="prefetch" href="/fun-io/assets/js/9.0666aee1.js">
    <link rel="stylesheet" href="/fun-io/assets/css/0.styles.6963bb8e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fun-io/" class="home-link router-link-active"><!----> <span class="site-name">Fun I/O</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/fun-io/" class="sidebar-link">Home</a></li><li><a href="/fun-io/module-structure-and-features.html" class="sidebar-link">Module Structure And Features</a></li><li><a href="/fun-io/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/fun-io/basic-archive-processing.html" class="active sidebar-link">Basic Archive Processing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fun-io/basic-archive-processing.html#packing-an-archive-file" class="sidebar-link">Packing An Archive File</a></li><li class="sidebar-sub-header"><a href="/fun-io/basic-archive-processing.html#unpacking-an-archive-file" class="sidebar-link">Unpacking An Archive File</a></li><li class="sidebar-sub-header"><a href="/fun-io/basic-archive-processing.html#transforming-an-archive-file" class="sidebar-link">Transforming An Archive File</a></li><li class="sidebar-sub-header"><a href="/fun-io/basic-archive-processing.html#working-with-s3-buckets" class="sidebar-link">Working with S3 Buckets</a></li></ul></li><li><a href="/fun-io/advanced-archive-processing.html" class="sidebar-link">Advanced Archive Processing</a></li></ul> </div> <div class="page"><!---->  <div class="content"><h1 id="basic-archive-processing"><a href="#basic-archive-processing" class="header-anchor">#</a> Basic Archive Processing</h1> <h2 id="packing-an-archive-file"><a href="#packing-an-archive-file" class="header-anchor">#</a> Packing An Archive File</h2> <div><p>The following code packs the TAR.GZ file <code>archive.tar.gz</code> from the directory <code>directory</code>.
It uses the <code>CommonsCompress</code> facade for accessing the TAR file format and transforming it to TAR.GZ using Apache
Commons Compress.
It also uses the <code>BIOS</code> facade for accessing directories like archive files and copying them:</p></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>gzip<span class="token punctuation">;</span> <span class="token comment">// from `fun-io-commons-compress`</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>tar<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>copy<span class="token punctuation">;</span>                        <span class="token comment">// from `fun-io-bios`</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>directory<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>file<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Scratch</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token function">directory</span><span class="token punctuation">(</span><span class="token string">&quot;directory&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">tar</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">&quot;archive.tar.gz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token function">gzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="unpacking-an-archive-file"><a href="#unpacking-an-archive-file" class="header-anchor">#</a> Unpacking An Archive File</h2> <p>The following code is the inverse of the previous operation:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>gzip<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>tar<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>copy<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>directory<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>file<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Scratch</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token function">tar</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">&quot;archive.tar.gz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token function">gzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">directory</span><span class="token punctuation">(</span><span class="token string">&quot;directory&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="transforming-an-archive-file"><a href="#transforming-an-archive-file" class="header-anchor">#</a> Transforming An Archive File</h2> <div><p>The following code transforms the TAR.GZ file <code>archive.tar.gz</code> to the ZIP file <code>archive.zip</code>.
When calling the <code>copy</code> method, all archive entries are directly &quot;streamed&quot; from the input archive to the output archive <em>without</em> buffering them in a temporary file, so this operation is fast and space efficient:</p></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>gzip<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>tar<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>zip<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>copy<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>file<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Scratch</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token function">tar</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">&quot;archive.tar.gz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token function">gzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">zip</span><span class="token punctuation">(</span><span class="token string">&quot;archive.zip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="working-with-s3-buckets"><a href="#working-with-s3-buckets" class="header-anchor">#</a> Working with S3 Buckets</h2> <p>Fun I/O treats S3 buckets like archive files.
This feature enables you to copy and transform data between an S3 bucket (with an optional key prefix) and any other
supported archive file, directory or S3 bucket (with an optional key prefix).</p> <p>Fun I/O provides two modules for accessing S3:</p> <div><ul><li>Fun I/O AWS SDK1 (alias <code>fun-io-aws-sdk1</code>) depends on the Amazon SDK for Java and provides the package
<code>global.namespace.fun.io.aws.sdk1</code>.</li> <li>Fun I/O AWS SDK2 (alias <code>fun-io-aws-sdk2</code>) depends on the Amazon SDK for Java 2 and provides the package
<code>global.namespace.fun.io.aws.sdk2</code>.</li></ul></div> <div><p>Both packages provide a facade class named <code>AWS</code> with identical behavior.</p></div> <div><p>The following code uses Fun I/O AWS SDK1 to &quot;unpack&quot; the TAR.GZ file <code>archive.tgz</code> to the S3 bucket <code>bucket</code> with the
key prefix <code>archive/</code>:</p></div> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>services<span class="token punctuation">.</span>s3</span><span class="token punctuation">.</span><span class="token class-name">AmazonS3</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>services<span class="token punctuation">.</span>s3</span><span class="token punctuation">.</span><span class="token class-name">AmazonS3ClientBuilder</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>aws<span class="token punctuation">.</span>sdk1</span><span class="token punctuation">.</span>AWS<span class="token punctuation">.</span>s3<span class="token punctuation">;</span> <span class="token comment">// from `fun-io-aws-sdk1`</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>copy<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>bios</span><span class="token punctuation">.</span>BIOS<span class="token punctuation">.</span>file<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>gzip<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">global<span class="token punctuation">.</span>namespace<span class="token punctuation">.</span>fun<span class="token punctuation">.</span>io<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>compress</span><span class="token punctuation">.</span><span class="token class-name">CommonsCompress</span><span class="token punctuation">.</span>tar<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Scratch</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">AmazonS3</span> client <span class="token operator">=</span> <span class="token class-name">AmazonS3ClientBuilder</span><span class="token punctuation">.</span><span class="token function">defaultClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token function">tar</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">&quot;archive.tgz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token function">gzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">s3</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> <span class="token string">&quot;bucket&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;archive/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>If provided, the key prefix must be either empty or a normalized path which ends with a <code>/</code>.
Absolute paths or referencing parent directories is not allowed.
For example, the following key prefixes are <strong>invalid</strong>:</p> <ul><li><code>path</code> doesn't end with a <code>/</code>.</li> <li><code>/path/</code> is an absolute path.</li> <li><code>./path/</code> is not in normalized form.</li> <li><code>../path/</code> references the parent directory.</li></ul></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/fun-io/getting-started.html" class="prev">
          Getting Started
        </a></span> <span class="next"><a href="/fun-io/advanced-archive-processing.html">
          Advanced Archive Processing
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/fun-io/assets/js/app.6955aee8.js" defer></script><script src="/fun-io/assets/js/5.abe7762f.js" defer></script>
  </body>
</html>
